#!/bin/bash

NTHREADS=8;

#E=( 0.25 0.50 0.75 1.00 1.50 2.00 2.50 3.00 3.50 4.00 4.50 5.00 5.50 6.00 6.50 7.00 7.50 8.00 8.50 9.00 );
E=( 1.00 5.00 );
D=( 0.10 0.20 0.30 0.40 0.50 0.60 0.70 0.80 0.90 1.10 1.20 1.30 1.40 1.50 1.60 1.70 1.80 1.90 2.10 2.20 2.30 2.40 2.50 2.60 2.70 2.80 2.90 );
#D=( 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00 17.00 18.00 19.00 20.00 21.00 22.00 23.00 24.00 25.00 26.00 27.00 28.00 29.00 30.00 31.00 32.00 33.00 34.00 35.00 36.00 37.00 38.00 39.00 40.00 41.00 42.00 43.00 44.00 45.00 46.00 47.00 48.00 49.00 50.00 51.00 52.00 53.00 54.00 55.00 56.00 57.00 58.00 59.00 60.00 61.00 62.00 63.00 64.00 65.00 66.00 67.00 68.00 69.00 70.00 71.00 72.00 73.00 74.00 75.00 76.00 77.00 78.00 79.00 80.00 81.00 82.00 83.00 84.00 85.00 86.00 87.00 88.00 89.00 );
MSC=( msc );
HOM=( inhom );

for (( i=0; i<${#HOM[*]}; i++ )); do
    for (( j=0; j<${#MSC[*]}; j++ )); do
        for (( k=0; k<${#D[*]}; k++ )); do
            for (( l=0; l<${#E[*]}; )); do
                N=`ps axu | grep resolution | grep -v grep | wc -l`;
                if [[ N -lt NTHREADS ]]; then
                    filestem=perdaix_${E[l]}_GeV_${D[k]}_deg_${MSC[j]}_${HOM[i]};
                    resolution mac/${filestem}.mac >& out/${filestem}.out&
                    l=$(expr $l + 1);
                fi;
                sleep 1;
            done;
        done;
    done;
done


